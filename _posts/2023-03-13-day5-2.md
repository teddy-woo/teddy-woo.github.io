---
date: 2023-03-13 00:00:00
layout: post
title: DevOps&#91;Day5-2&#93; / [ë¦¬ëˆ…ìŠ¤ ìš´ì˜ì²´ì œ]
subtitle: '07. ì„œë¹„ìŠ¤ ê´€ë¦¬'
description: 07. ì„œë¹„ìŠ¤ ê´€ë¦¬
image: /linux.png
optimized_image: /linux.png
category: ë¦¬ëˆ…ìŠ¤ ìš´ì˜ì²´ì œ
tags:
  - linux
  - DevOps BootCamp
author: teddy-woo

---

## **# í•™ìŠµ ëª©í‘œ**

- ì„œë¹„ìŠ¤ ê´€ë¦¬
    - ì‹œìŠ¤í…œ ê´€ë¦¬ìê°€ í•˜ëŠ” ì¼ì„ ì´í•´í•  ìˆ˜ ìˆë‹¤.
    - ì‚¬ìš©ì ë° ë£¨íŠ¸ ê¶Œí•œì— ëŒ€í•´ ì´í•´í•˜ê³ , ì‚¬ìš©ì ë° ê·¸ë£¹ ê´€ë¦¬ë¥¼ í•  ìˆ˜ìˆë‹¤.
    - íŒŒì¼ì˜ ê¶Œí•œì„ ë³€ê²½í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.
    - í”„ë¡œê·¸ë¨ê³¼ í”„ë¡œì„¸ìŠ¤ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³ , í”„ë¡œì„¸ìŠ¤ë¥¼ í™•ì¸/ì¢…ë£Œí•  ìˆ˜ ìˆë‹¤.
    - ë°±ê·¸ë¼ìš´ë“œ í”„ë¡œì„¸ìŠ¤ì™€ ì„œë¹„ìŠ¤ë¥¼ ì´í•´í•˜ê³ , ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.
    - cronÂ ë°Â bashÂ ìŠ¤í¬ë¦½íŠ¸ë¥¼Â ì´ìš©í•´ì„œÂ ìë™í™”ë¥¼Â í• Â ìˆ˜Â ìˆë‹¤.

---

## **# í•™ìŠµ ë‚´ìš©**

### **1. ë°ëª¬ê³¼ ì„œë¹„ìŠ¤**

- **ë°ëª¬ê³¼ ì„œë¹„ìŠ¤**
    
    
    | ë°ëª¬ | ì„œë¹„ìŠ¤ |
    | --- | --- |
    | - ë¦¬ëˆ…ìŠ¤ í™˜ê²½ì—ì„œ ì‹œìŠ¤í…œ ì´ˆê¸°í™” í›„ initì´ë¼ëŠ” íŠ¹ë³„í•œ í”„ë¡œê·¸ë¨ì— ì˜í•´ ìë°œì ìœ¼ë¡œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•˜ëŠ” í”„ë¡œê·¸ë¨- ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‘ë™í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¼ëŠ” ì˜ë¯¸ë¡œ í†µìš©(ex) syslogd, httpd ì²˜ëŸ¼ í”„ë¡œê·¸ë¨ ì´ë¦„ ëì— dê°€ ë¶™ëŠ” í”„ë¡œì„¸ìŠ¤- ìˆ˜í–‰í•˜ëŠ” ì¼Â > í•˜ë“œì›¨ì–´ ì¥ì¹˜ ê´€ë¦¬Â > ë³´ì¡° ê¸°ì–µì¥ì¹˜ì™€ ë””ë ‰í† ë¦¬ ì—°ê²°(ë§ˆìš´íŠ¸)Â > ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ í”„ë¡œì„¸ìŠ¤ê°„ í†µì‹ (ì†Œì¼“)Â > ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì˜ ì„œë¹„ìŠ¤ ì œê³µ- ìš´ì˜ì²´ì œì˜ ê´€ì  | - ë°ëª¬ì˜ ì—­í•  ì¤‘ ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì˜ ì„œë¹„ìŠ¤ë¥¼ ê°„ëµí•˜ê²Œ ì§€ì¹­í•˜ëŠ” ê²ƒ- ì‚¬ìš©ìì˜ ê´€ì  |
    
- **ëŒ€í‘œì ì¸ ë°ëª¬ì˜ ì˜ˆ: ì›¹ ì„œë²„ (httpd)**
    - (ì‹¤ìŠµ)Â ê°„ë‹¨í•œ HTML íŒŒì¼ì„ ë§Œë“¤ì–´ ì›¹ì„œë²„ì— ë„ì›Œ crulì´ë¼ëŠ” ìœ í‹¸ë¦¬í‹°ë¥¼ í†µí•´ í•´ë‹¹ ì£¼ì†Œë¡œ ì ‘ì†

```bash
# index.html íŒŒì¼ ìƒì„±
roheerumi@devops:~/devops$ echo "<html><body><h1>roheerumi test</h1></body></html>" > index.html

# ì›¹ ì„œë²„ ì‹¤í–‰ í›„ 8888 í¬íŠ¸ ì˜¤í”ˆ
roheerumi@devops:~/devops$ busybox httpd -h . -p 8888# ê°ì¢… ìœ í‹¸ë¦¬í‹°ë¥¼ ë‹´ì€ ë¦¬ëˆ…ìŠ¤ìš© ì• í”Œë¦¬ì¼€ì´ì…˜# ì›¹ ì„œë²„ ì ‘ì†
roheerumi@devops:~/devops$ curl http://localhost:8888
<html><body><h1>roheerumi test</h1></body></html>

# í”„ë¡œì„¸ìŠ¤ í™•ì¸ ëª…ë ¹ìœ¼ë¡œ httpd ë°ëª¬ ì‘ë™ ì—¬ë¶€ í™•ì¸
roheerumi@devops:~/devops$ ps aux | grep httpd
roheeru+    3659  0.0  0.0   2428    72 ?        Ss   11:21   0:00 busybox httpd -h . -p 8888
roheeru+    3665  0.0  0.0  18992   712 pts/1    R+   11:21   0:00 grep --color=auto httpd

# PIDë¡œ í•´ë‹¹ ë°ëª¬ kill
roheerumi@devops:~/devops$ kill -9 3659

# í•´ë‹¹ ì›¹ì„œë²„ ì ‘ì† ì‹¤íŒ¨
roheerumi@devops:~/devops$ curl http://localhost:8888
curl: (7) Failed to connect to localhost port 8888: ì—°ê²°ì´ ê±°ë¶€ë¨
```

### **2. ëŒ€í‘œì ì¸ ë°ëª¬: cron**

- **ëŒ€í‘œì ì¸ ë°ëª¬ì˜ ì˜ˆ: cron ë°ëª¬**
    - ìŠ¤ì¼€ì¥´ì— ë”°ë¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‘ì—…ì„ ì‹¤í–‰í•˜ëŠ” ë„êµ¬
    - í¬ë¡ íƒ­ ì‚¬ìš© ë¬¸ë²•:
        
        
        | ì‚¬ìš©ë²• | ì˜ë¯¸ |
        | --- | --- |
        | ë¶„ / ì‹œ / ì¼ / ì›” / ìš”ì¼ / ì‘ì—… | - ë¶„ : 0 ~ 59ë¶„ë¡œ í‘œí˜„- ì‹œ : 0 ~ 23ì‹œë¡œ í‘œí˜„- ì¼ : 1 ~ 31ì¼ë¡œ í‘œí˜„- ì›” : 1 ~ 12ì›”ë¡œ í‘œí˜„- ìš”ì¼ : 0(ì¼ìš”ì¼) ~ 6(í† ìš”ì¼)ë¡œ í‘œí˜„Â > * : ì‹œê°„ì„ í‘œí˜„í•˜ëŠ” ê° í•„ë“œë“¤ì€ ê°ê° *ë¡œ í‘œí˜„ ê°€ëŠ¥í•˜ë©° ê·¸ëŸ´ ê²½ìš° ëª¨ë“  ì‹œê°„ì„ ì˜ë¯¸Â > /ê°„ê²© : ë§¤ ê°„ê²©ì„ í‘œì‹œ- ì‘ì—…: ì§€ì •ëœ ì‹œê°„ì— ìˆ˜í–‰í•  ì‘ì—…ì„ ì ˆëŒ€ ê²½ë¡œë¡œ ê¸°ìˆ , í•„ìš”í•œ ì˜µì…˜ ë° ì¸ìˆ˜ë¥¼ í•¨ê»˜ ë‚˜ì—´ |
   
    - ì˜ˆì‹œ
        
        
        | ì‚¬ìš© ì˜ˆì‹œ | ì˜ë¯¸ |
        | --- | --- |
        | 0 1 * * * batch.sh | ë§¤ì¼ 01ì‹œì— batch.sh ì‹¤í–‰ |
        | 0 8-10 * * * batch.sh | ë§¤ì¼ 08ì‹œ - 10ì‹œì— batch.sh ì‹¤í–‰ |
        | 0 1,2,5 * * * batch.sh | ë§¤ì¼ 01, 02, 05ì‹œì— batch.sh ì‹¤í–‰ |
        | */5 * * * * batch.sh | ë§¤ 5ë¶„ ê°„ê²©ìœ¼ë¡œ batch.sh ì‹¤ |
   
    - (ì‹¤ìŠµ) ë§¤ ë¶„ë§ˆë‹¤ ë‚ ì§œì™€ ì‹œìŠ¤í…œ ê°€ë™ ì‹œê°„ì„ íŒŒì¼ì— ê¸°ë¡

```bash
# í¬ë¡ íƒ­ì— ìŠ¤ì¼€ì¥´ ë“±ë¡
roheerumi@devops:~/devops$ crontab -e# edit í¬ë¡ íƒ­ íŒŒì¼ ìˆ˜ì •
no crontab for roheerumi - using an empty one

Select an editor.  To change later, run 'select-editor'.
  1. /bin/nano        <---- easiest
  2. /usr/bin/vim.basic
  3. /usr/bin/vim.tiny
  4. /bin/ed

Choose 1-4 [1]: 1# nano ì—ë””í„°ë¡œ ë“±ë¡# ë“±ë¡ ë‚´ìš© * * * * * echo $(/bin/date) - $(/usr/bin/uptime) >> ~/uptime.log# ì •ìƒì ìœ¼ë¡œ í¬ë¡ íƒ­ ë“±ë¡
crontab: installing new crontab

# ë¡œê·¸ ê¸°ë¡ ì¤‘ í™•ì¸
roheerumi@devops:~/devops$ cd ..
roheerumi@devops:~$ ls
devops  uptime.log  ê³µê°œ  ë‹¤ìš´ë¡œë“œ  ë¬¸ì„œ  ë°”íƒ•í™”ë©´  ë¹„ë””ì˜¤  ì‚¬ì§„  ìŒì•…  í…œí”Œë¦¿
roheerumi@devops:~$ tail -f uptime.log
2023. 03. 13. (ì›”) 11:25:01 KST - 11:25:01 up 26 min, 1 user, load average: 0.06, 0.16, 0.18
2023. 03. 13. (ì›”) 11:26:01 KST - 11:26:01 up 27 min, 1 user, load average: 0.02, 0.12, 0.17

# ë“±ë¡í•œ í¬ë¡ íƒ­ ì‚­ì œ
roheerumi@devops:~$ crontab -r# remove, í¬ë¡ íƒ­ ì‚­ì œ
roheerumi@devops:~$ crontab -l# list, í¬ë¡ íƒ­ í™•ì¸
no crontab for roheerumi
```

### **3. ì„œë¹„ìŠ¤Â ê´€ë¦¬Â (systemctl)**

- **systemctl**
    - ëª¨ë“  ë°ëª¬ì˜ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆëŠ” ëª…ë ¹ì–´
        
        
        | ì‚¬ìš© ë°©ë²• | ì˜ë¯¸ |
        | --- | --- |
        | systemctlÂ --type=[íƒ€ì…ëª…] | --type=[íƒ€ì…ëª…] : í•´ë‹¹ íƒ€ì…ì— í•´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ë§Œ ì¶œë ¥(ex) systemctl --type=service : ì„œë¹„ìŠ¤ ëª©ë¡ë§Œ ì¶œë ¥ |
        | systemctlÂ list-unit-files | ì„¤ì¹˜ëœ ìœ ë‹›(ë°ëª¬) ì¶œë ¥ |
        | systemctl enable ìœ ë‹›ëª… | ë¶€íŒ… ì‹œ ìœ ë‹› í™œì„±í™” |
        | systemctl disableÂ ìœ ë‹›ëª… | ìœ ë‹›ì´ ë¶€íŒ… ì‹œ ë¹„í™œì„±í™” |
        | systemctl startÂ ìœ ë‹›ëª… | ìœ ë‹›ì„ ì¦‰ì‹œ í™œì„±í™” |
        | systemctl stopÂ ìœ ë‹›ëª… | ìœ ë‹›ì„ ì¦‰ì‹œ ë¹„í™œì„±í™” |
        | systemctl restartÂ ìœ ë‹›ëª… | ìœ ë‹›ì„ ì¦‰ì‹œ ì¬ì‹œì‘ |
        | systemctl statusÂ ìœ ë‹›ëª… | ìœ ë‹›ì˜ ìƒíƒœ, ìµœê·¼ ë¡œê·¸ ì¡°íšŒ |

### ! Action Item !

<aside>
ğŸ’¡ Q1. ë¡œê·¸ì— ë”°ë¥´ë©´, ìµœê·¼ì— cron ë°ëª¬ì€ ì–´ë–¤ ëª…ë ¹ì„ ì‹¤í–‰ì‹œì¼°ë‚˜ìš”?

</aside>

<aside>
ğŸ’¡ Q2. ë˜í•œ ì„œë¹„ìŠ¤ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ë ¤ë©´ ì–´ë–¤ ëª…ë ¹ì„ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”?

</aside>

```bash
# Q1. í¬ë¡  ë¡œê·¸ í™•ì¸ :  CMD (echo $(/bin/date) - $(/usr/bin/uptime) >> ~/uptime.log) ëª…ë ¹ ì‹¤í–‰
roheerumi@devops:~$ systemctl status -l cron# cron ë°ëª¬ì˜ ë¡œê·¸ í™•ì¸
â— cron.service - Regular background program processing daemon
     Loaded: loaded (/lib/systemd/system/cron.service; enabled; vendor preset: enabled)
     Active: active (running) since Mon 2023-03-13 10:58:50 KST; 42min ago
       Docs: man:cron(8)
   Main PID: 602 (cron)
      Tasks: 1 (limit: 4615)
     Memory: 500.0K
     CGroup: /system.slice/cron.service
             â””â”€602 /usr/sbin/cron -f

 3ì›” 13 11:25:01 devops CRON[3700]: (roheerumi) CMD (echo $(/bin/date) - $(/usr/bin/uptime) >> ~/uptime.log)
 3ì›” 13 11:25:01 devops CRON[3699]: pam_unix(cron:session): session closed for user roheerumi
 3ì›” 13 11:26:01 devops CRON[3736]: pam_unix(cron:session): session opened for user roheerumi by (uid=0)
 3ì›” 13 11:26:01 devops CRON[3737]: (roheerumi) CMD (echo $(/bin/date) - $(/usr/bin/uptime) >> ~/uptime.log)
 3ì›” 13 11:26:01 devops CRON[3736]: pam_unix(cron:session): session closed for user roheerumi
 3ì›” 13 11:27:01 devops CRON[3766]: pam_unix(cron:session): session opened for user roheerumi by (uid=0)
 3ì›” 13 11:27:01 devops CRON[3767]: (roheerumi) CMD (echo $(/bin/date) - $(/usr/bin/uptime) >> ~/uptime.log)
 3ì›” 13 11:27:01 devops CRON[3766]: pam_unix(cron:session): session closed for user roheerumi
 3ì›” 13 11:30:01 devops CRON[3811]: pam_unix(cron:session): session opened for user root by (uid=0)
 3ì›” 13 11:30:01 devops CRON[3811]: pam_unix(cron:session): session closed for user root

# Q2. í¬ë¡  ì¬ì‹œì‘
roheerumi@devops:~$ systemctl restart cron
roheerumi@devops:~$ ps -ef | grep cron
root        4011       1  0 11:43 ?        00:00:00 /usr/sbin/cron -f
roheeru+    4014    1853  0 11:43 pts/1    00:00:00 grep --color=auto cron

# í¬ë¡  ì¢…ë£Œ
roheerumi@devops:~$ systemctl stop cron
roheerumi@devops:~$ ps -ef | grep cron
roheeru+    4049    1853  0 11:45 pts/1    00:00:00 grep --color=auto cron
```
